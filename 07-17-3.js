javascript:(async () => {  /*   * =======================================================================   * %E5%87%B1%E5%9F%BA%E4%BA%BA%E5%A3%BD%E6%A1%88%E4%BB%B6%E6%9F%A5%E8%A9%A2%E5%B7%A5%E5%85%B7 - %E6%9C%80%E7%B5%82%E5%84%AA%E5%8C%96%E7%89%88   *   * %E6%9E%B6%E6%A7%8B%E8%A8%AD%E8%A8%88%E7%90%86%E5%BF%B5:   * 1. IIFE (%E7%AB%8B%E5%8D%B3%E5%9F%B7%E8%A1%8C%E5%87%BD%E5%BC%8F%E8%A1%A8%E9%81%94%E5%BC%8F): %E5%B0%87%E6%89%80%E6%9C%89%E7%A8%8B%E5%BC%8F%E7%A2%BC%E5%8C%85%E8%A3%B9%E8%B5%B7%E4%BE%86%EF%BC%8C%E9%81%BF%E5%85%8D%E6%B1%A1%E6%9F%93%E5%85%A8%E5%9F%9F%E5%91%BD%E5%90%8D%E7%A9%BA%E9%96%93%EF%BC%8C%E9%81%A9%E5%90%88%E4%BD%9C%E7%82%BA%E6%9B%B8%E7%B1%A4%E5%B7%A5%E5%85%B7%E3%80%82   * 2. StateManager (%E7%8B%80%E6%85%8B%E7%AE%A1%E7%90%86%E5%99%A8): %E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E6%89%80%E6%9C%89%E6%9C%83%E8%AE%8A%E5%8B%95%E7%9A%84%E8%B3%87%E6%96%99%EF%BC%8C%E5%A6%82API%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%E3%80%81CSV%E5%8C%AF%E5%85%A5%E5%85%A7%E5%AE%B9%E7%AD%89%E3%80%82   * %E6%89%80%E6%9C%89%E8%B3%87%E6%96%99%E7%9A%84%E4%BF%AE%E6%94%B9%E9%83%BD%E6%87%89%E9%80%8F%E9%81%8E%E6%AD%A4%E7%89%A9%E4%BB%B6%EF%BC%8C%E4%B8%A6%E6%8F%90%E4%BE%9B%E5%BF%AB%E7%85%A7%E6%AD%B7%E5%8F%B2%EF%BC%8C%E7%82%BA%E6%9C%AA%E4%BE%86%E7%9A%84%E3%80%8C%E5%BE%A9%E5%8E%9F%E3%80%8D%E5%8A%9F%E8%83%BD%E5%A5%A0%E5%AE%9A%E5%9F%BA%E7%A4%8E%E3%80%82   * 3. Manager (%E9%82%8F%E8%BC%AF%E7%AE%A1%E7%90%86%E5%99%A8): %E5%B0%87%E4%B8%8D%E5%90%8C%E9%A0%98%E5%9F%9F%E7%9A%84%E5%95%86%E6%A5%AD%E9%82%8F%E8%BC%AF%E5%B0%81%E8%A3%9D%E5%9C%A8%E7%8D%A8%E7%AB%8B%E7%9A%84%E7%89%A9%E4%BB%B6%E4%B8%AD (%E5%A6%82 TokenManager, A17ModeManager)%E3%80%82   * 4. UIManager (%E4%BD%BF%E7%94%A8%E8%80%85%E4%BB%8B%E9%9D%A2%E7%AE%A1%E7%90%86%E5%99%A8): %E5%B0%88%E9%96%80%E8%B2%A0%E8%B2%AC%E6%89%80%E6%9C%89%E8%88%87DOM%E6%B8%B2%E6%9F%93%E3%80%81%E6%9B%B4%E6%96%B0%E3%80%81%E4%BA%92%E5%8B%95%E7%9B%B8%E9%97%9C%E7%9A%84%E6%93%8D%E4%BD%9C%EF%BC%8C%E5%AF%A6%E7%8F%BE%E8%B3%87%E6%96%99%E8%88%87%E8%A6%96%E5%9C%96%E7%9A%84%E5%88%86%E9%9B%A2%E3%80%82   * =======================================================================   */  // ========== %E6%A0%B8%E5%BF%83%E8%A8%AD%E5%AE%9A%E8%88%87%E5%B8%B8%E6%95%B8 ==========  const CONFIG = {    API_URLS: {      test: 'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query',      prod: 'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query'    },    STORAGE_KEYS: {      TOKEN: 'euisToken_v2',      A17_SETTINGS: 'kgilifeQueryTool_A17TextSettings_v4'    },    TOOL_ID_PREFIX: 'kgilifeQueryToolContainer_vOpt',    Z_INDEX: {      OVERLAY: 2147483640,      MAIN_UI: 2147483630,      NOTIFICATION: 2147483647    },    QUERYABLE_FIELDS: [      { queryApiKey: 'receiptNumber', queryDisplayName: '%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC', color: '#007bff'%20},%20%20%20%20%20%20{%20queryApiKey:%20'applyNumber',%20queryDisplayName:%20'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',%20color:%20'#6f42c1'%20},%20%20%20%20%20%20{%20queryApiKey:%20'policyNumber',%20queryDisplayName:%20'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',%20color:%20'#28a745'%20},%20%20%20%20%20%20{%20queryApiKey:%20'approvalNumber',%20queryDisplayName:%20'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',%20color:%20'#fd7e14'%20},%20%20%20%20%20%20{%20queryApiKey:%20'insuredId',%20queryDisplayName:%20'%E8%A2%AB%E4%BF%9D%E4%BA%BAID',%20color:%20'#17a2b8'%20}%20%20%20%20],%20%20%20%20FIELD_DISPLAY_NAMES:%20{%20%20%20%20%20%20applyNumber:%20'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',%20policyNumber:%20'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',%20approvalNumber:%20'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',%20%20%20%20%20%20receiptNumber:%20'%E9%80%81%E9%87%91%E5%96%AE',%20insuredId:%20'%E8%A2%AB%E4%BF%9D%E4%BA%BAID',%20statusCombined:%20'%E7%8B%80%E6%85%8B',%20%20%20%20%20%20mainStatus:%20'%E4%B8%BB%E7%8B%80%E6%85%8B',%20subStatus:%20'%E6%AC%A1%E7%8B%80%E6%85%8B',%20uwApproverUnit:%20'%E5%88%86%E5%85%AC%E5%8F%B8',%20%20%20%20%20%20uwApprover:%20'%E6%A0%B8%E4%BF%9D%E5%93%A1',%20approvalUser:%20'%E8%A6%86%E6%A0%B8',%20_queriedValue_:%20'%E6%9F%A5%E8%A9%A2%E5%80%BC',%20%20%20%20%20%20NO:%20'%E5%BA%8F%E8%99%9F',%20_apiQueryStatus:%20'%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C'%20%20%20%20},%20%20%20%20ALL_DISPLAY_API_KEYS:%20['applyNumber',%20'policyNumber',%20'approvalNumber',%20'receiptNumber',%20'insuredId',%20'statusCombined',%20'uwApproverUnit',%20'uwApprover',%20'approvalUser'],%20%20%20%20UNIT_MAPPINGS:%20{%20H:%20'%E6%A0%B8%E4%BF%9D%E9%83%A8',%20B:%20'%E5%8C%97%E4%B8%80',%20C:%20'%E5%8F%B0%E4%B8%AD',%20K:%20'%E9%AB%98%E9%9B%84',%20N:%20'%E5%8F%B0%E5%8D%97',%20P:%20'%E5%8C%97%E4%BA%8C',%20T:%20'%E6%A1%83%E7%AB%B9',%20G:%20'%E4%BF%9D%E4%BD%9C'%20},%20%20%20%20A17_UNIT_DEFS:%20[%20%20%20%20%20%20{%20id:%20'H',%20label:%20'H-%E7%B8%BD%E5%85%AC%E5%8F%B8',%20color:%20'#007bff'%20},%20{%20id:%20'B',%20label:%20'B-%E5%8C%97%E4%B8%80',%20color:%20'#28a745'%20},%20%20%20%20%20%20{%20id:%20'P',%20label:%20'P-%E5%8C%97%E4%BA%8C',%20color:%20'#ffc107'%20},%20{%20id:%20'T',%20label:%20'T-%E6%A1%83%E7%AB%B9',%20color:%20'#17a2b8'%20},%20%20%20%20%20%20{%20id:%20'C',%20label:%20'C-%E5%8F%B0%E4%B8%AD',%20color:%20'#fd7e14'%20},%20{%20id:%20'N',%20label:%20'N-%E5%8F%B0%E5%8D%97',%20color:%20'#6f42c1'%20},%20%20%20%20%20%20{%20id:%20'K',%20label:%20'K-%E9%AB%98%E9%9B%84',%20color:%20'#e83e8c'%20},%20{%20id:%20'UNDEF',%20label:%20'%E6%9F%A5%E7%84%A1%E5%96%AE%E4%BD%8D',%20color:%20'#546e7a'%20}%20%20%20%20],%20%20%20%20UNIT_MAP_API_KEY:%20'uwApproverUnit'%20%20};%20%20//%20==========%20%E7%8B%80%E6%85%8B%E7%AE%A1%E7%90%86%E5%99%A8%20(The%20Single%20Source%20of%20Truth)%20==========%20%20const%20StateManager%20=%20{%20%20%20%20currentEnv:%20'test',%20%20%20%20apiAuthToken:%20null,%20%20%20%20selectedQueryDef:%20CONFIG.QUERYABLE_FIELDS[0],%20%20%20%20isEditMode:%20false,%20%20%20%20originalQueryResults:%20[],%20%20%20%20baseA17MasterData:%20[],%20%20%20%20csvImport:%20{%20%20%20%20%20%20fileName:%20'',%20%20%20%20%20%20rawHeaders:%20[],%20%20%20%20%20%20rawData:%20[],%20%20%20%20%20%20selectedColForQueryName:%20null,%20%20%20%20%20%20selectedColsForA17Merge:%20[],%20%20%20%20%20%20isA17CsvPrepared:%20false%20%20%20%20},%20%20%20%20a17Mode:%20{%20%20%20%20%20%20isActive:%20false,%20%20%20%20%20%20selectedUnits:%20new%20Set(),%20%20%20%20%20%20textSettings:%20{%20%20%20%20%20%20%20%20mainContent:%20%22DEAR,\n\n%E4%BE%9D%E6%93%9A%E3%80%90%E7%AE%A1%E7%90%86%E5%A0%B1%E8%A1%A8%EF%BC%9AA17%20%E6%96%B0%E5%A5%91%E7%B4%84%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%E3%80%91%E6%89%80%E8%BC%89%E5%85%A7%E5%AE%B9%EF%BC%8C%E5%A0%B1%E8%A1%A8%E4%B8%AD%E5%88%97%E7%A4%BA%E4%B9%8B%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%8C%E6%B6%89%E5%8F%8A%E5%A4%9A%E9%A0%85%E5%B8%B3%E5%8B%99%E7%95%B0%E5%B8%B8%E6%83%85%E5%BD%A2%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%E6%BA%A2%E7%B9%B3%E3%80%81%E7%9F%AD%E6%94%B6%E3%80%81%E5%8F%96%E6%B6%88%E4%BB%B6%E9%9C%80%E9%80%80%E8%B2%BB%E3%80%81%E4%BB%A5%E5%8F%8A%E7%84%A1%E7%9B%B8%E5%B0%8D%E6%87%89%E4%B9%8B%E6%A1%88%E4%BB%B6%E7%AD%89%E5%95%8F%E9%A1%8C%E3%80%82\n\n%E6%9C%AC%E9%80%B1%E6%88%91%E5%80%91%E5%B7%B2%E9%80%90%E7%AD%86%E6%9F%A5%E8%A9%A2%E8%A9%B2%E7%AD%89%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%EF%BC%8C%E7%B5%90%E6%9E%9C%E9%A1%AF%E7%A4%BA%EF%BC%8C%E9%80%99%E4%BA%9B%E9%80%81%E9%87%91%E5%96%AE%E6%87%89%E5%B0%8D%E6%87%89%E8%87%B3%E4%B8%8B%E8%A1%A8%E6%89%80%E5%88%97%E4%B9%8B%E6%96%B0%E5%A5%91%E7%B4%84%E6%A1%88%E4%BB%B6%E3%80%82%E7%82%BA%E5%88%A9%E5%BE%8C%E7%BA%8C%E5%B8%B3%E5%8B%99%E8%99%95%E7%90%86%EF%BC%8C%E6%95%AC%E8%AB%8B%E5%8D%94%E5%8A%A9%E7%A2%BA%E8%AA%8D%E5%90%84%E6%A1%88%E4%BB%B6%E4%B9%8B%E5%AF%A6%E9%9A%9B%E5%B8%B3%E5%8B%99%E7%8B%80%E6%B3%81%EF%BC%8C%E4%B8%A6%E5%A6%82%E6%9C%89%E9%9C%80%E8%AA%BF%E6%95%B4%E6%88%96%E8%99%95%E7%90%86%E4%BA%8B%E9%A0%85%EF%BC%8C%E8%AB%8B%E4%B8%80%E4%BD%B5%E5%8D%94%E5%8A%A9%E8%BE%A6%E7%90%86%EF%BC%8C%E8%AC%9D%E8%AC%9D%E3%80%82%22,%20%20%20%20%20%20%20%20mainFontSize:%2012,%20mainLineHeight:%201.5,%20mainFontColor:%20'#333333',%20%20%20%20%20%20%20%20dateFontSize:%208,%20dateLineHeight:%201.2,%20dateFontColor:%20'#555555',%20%20%20%20%20%20%20%20genDateOffset:%20-3,%20compDateOffset:%200,%20%20%20%20%20%20}%20%20%20%20},%20%20%20%20history:%20[],%20%20%20%20%20%20%20%20resetCsvImportState()%20{%20%20%20%20%20%20%20%20this.csvImport%20=%20{%20%20%20%20%20%20%20%20%20%20%20%20fileName:%20'',%20rawHeaders:%20[],%20rawData:%20[],%20selectedColForQueryName:%20null,%20%20%20%20%20%20%20%20%20%20%20%20selectedColsForA17Merge:%20[],%20isA17CsvPrepared:%20false%20%20%20%20%20%20%20%20};%20%20%20%20},%20%20%20%20%20%20%20%20pushSnapshot(description%20=%20'')%20{%20%20%20%20%20%20this.history.push(structuredClone({%20%20%20%20%20%20%20%20description,%20%20%20%20%20%20%20%20timestamp:%20new%20Date().toISOString(),%20%20%20%20%20%20%20%20originalQueryResults:%20this.originalQueryResults,%20%20%20%20%20%20%20%20baseA17MasterData:%20this.baseA17MasterData,%20%20%20%20%20%20%20%20isEditMode:%20this.isEditMode%20%20%20%20%20%20}));%20%20%20%20%20%20if%20(this.history.length%20%3E%2010)%20this.history.shift();%20%20%20%20},%20%20%20%20undo()%20{%20%20%20%20%20%20if%20(this.history.length%20%3E%200)%20{%20%20%20%20%20%20%20%20const%20lastState%20=%20this.history.pop();%20%20%20%20%20%20%20%20this.originalQueryResults%20=%20lastState.originalQueryResults;%20%20%20%20%20%20%20%20this.baseA17MasterData%20=%20lastState.baseA17MasterData;%20%20%20%20%20%20%20%20this.isEditMode%20=%20lastState.isEditMode;%20%20%20%20%20%20%20%20UIManager.displayNotification(%60%E5%B7%B2%E5%BE%A9%E5%8E%9F%E6%93%8D%E4%BD%9C:%20${lastState.description}%60,%20false);%20%20%20%20%20%20%20%20return%20true;%20%20%20%20%20%20}%20%20%20%20%20%20UIManager.displayNotification('%E6%B2%92%E6%9C%89%E6%9B%B4%E5%A4%9A%E5%8F%AF%E5%BE%A9%E5%8E%9F%E7%9A%84%E6%93%8D%E4%BD%9C',%20true);%20%20%20%20%20%20return%20false;%20%20%20%20}%20%20};%20%20//%20==========%20%E9%80%9A%E7%94%A8%E8%BC%94%E5%8A%A9%E5%B7%A5%E5%85%B7%20==========%20%20const%20Utils%20=%20{%20%20%20%20escapeHtml(unsafe)%20{%20%20%20%20%20%20if%20(typeof%20unsafe%20!==%20'string')%20return%20unsafe%20===%20null%20||%20unsafe%20===%20undefined%20?%20''%20:%20String(unsafe);%20%20%20%20%20%20return%20unsafe.replace(/[&%3C%3E%22'%60]/g,%20m%20=%3E%20({%20%20%20%20%20%20%20%20'&':%20'&amp;',%20'%3C':%20'&lt;',%20'%3E':%20'&gt;',%20'%22':%20'&quot;',%20%22'%22:%20'&#039;',%20'%60':%20'&#x60;'%20%20%20%20%20%20})[m]%20||%20m);%20%20%20%20},%20%20%20%20formatDate(date)%20{%20%20%20%20%20%20const%20y%20=%20date.getFullYear();%20%20%20%20%20%20const%20m%20=%20String(date.getMonth()%20+%201).padStart(2,%20'0');%20%20%20%20%20%20const%20d%20=%20String(date.getDate()).padStart(2,%20'0');%20%20%20%20%20%20return%20%60${y}${m}${d}%60;%20%20%20%20},%20%20%20%20extractName(strVal)%20{%20%20%20%20%20%20if%20(!strVal%20||%20typeof%20strVal%20!==%20'string')%20return%20'';%20%20%20%20%20%20const%20matchResult%20=%20strVal.match(/^[\u4e00-\u9fa5\uff0a*\u00b7\uff0e]+/);%20%20%20%20%20%20return%20matchResult%20?%20matchResult[0]%20:%20strVal.split('%20')[0];%20%20%20%20},%20%20%20%20getFirstLetter(unitString)%20{%20%20%20%20%20%20if%20(!unitString%20||%20typeof%20unitString%20!==%20'string')%20return%20'Z';%20%20%20%20%20%20for%20(let%20i%20=%200;%20i%20%3C%20unitString.length;%20i++)%20{%20%20%20%20%20%20%20%20const%20char%20=%20unitString.charAt(i).toUpperCase();%20%20%20%20%20%20%20%20if%20(/[A-Z]/.test(char))%20return%20char;%20%20%20%20%20%20}%20%20%20%20%20%20return%20'Z';%20%20%20%20}%20%20};%20%20//%20==========%20UI%20%E4%BB%8B%E9%9D%A2%E7%AE%A1%E7%90%86%E5%99%A8%20==========%20%20const%20UIManager%20=%20{%20%20%20%20dom:%20{%20%20%20%20%20%20%20%20mainUI:%20null,%20%20%20%20%20%20%20%20tableHead:%20null,%20%20%20%20%20%20%20%20tableBody:%20null,%20%20%20%20%20%20%20%20a17UnitButtonsContainer:%20null,%20%20%20%20%20%20%20%20filterInput:%20null,%20%20%20%20%20%20%20%20summarySection:%20null,%20%20%20%20},%20%20%20%20state:%20{%20%20%20%20%20%20%20%20sortDirections:%20{},%20%20%20%20%20%20%20%20currentHeaders:%20[],%20%20%20%20%20%20%20%20drag:%20{%20dragging:%20false,%20startX:%200,%20startY:%200,%20initialX:%200,%20initialY:%200%20},%20%20%20%20%20%20%20%20a17ButtonLongPressTimer:%20null,%20%20%20%20},%20%20%20%20cleanup()%20{%20%20%20%20%20%20%20%20this.dom.mainUI?.remove();%20%20%20%20%20%20%20%20document.querySelectorAll(%60[id^=%22${CONFIG.TOOL_ID_PREFIX}%22]%60).forEach(el%20=%3E%20el.remove());%20%20%20%20%20%20%20%20document.removeEventListener('keydown',%20this.mainUIEscListener);%20%20%20%20%20%20%20%20document.removeEventListener('mousemove',%20this.dragMoveListener);%20%20%20%20%20%20%20%20document.removeEventListener('mouseup',%20this.dragEndListener);%20%20%20%20},%20%20%20%20%20%20%20%20displayNotification(message,%20isError%20=%20false,%20duration%20=%203000)%20{%20%20%20%20%20%20%20%20const%20id%20=%20%60${CONFIG.TOOL_ID_PREFIX}_Notification%60;%20%20%20%20%20%20%20%20document.getElementById(id)?.remove();%20%20%20%20%20%20%20%20const%20n%20=%20document.createElement('div');%20%20%20%20%20%20%20%20n.id%20=%20id;%20%20%20%20%20%20%20%20n.style.cssText%20=%20%60%20%20%20%20%20%20%20%20%20%20%20%20position:fixed;%20top:20px;%20right:20px;%20background-color:${isError%20?%20'#dc3545'%20:%20'#28a745'};%20%20%20%20%20%20%20%20%20%20%20%20color:white;%20padding:10px%2015px;%20border-radius:5px;%20z-index:${CONFIG.Z_INDEX.NOTIFICATION};%20%20%20%20%20%20%20%20%20%20%20%20font-size:14px;%20font-family:'Microsoft%20JhengHei',%20Arial,%20sans-serif;%20%20%20%20%20%20%20%20%20%20%20%20box-shadow:0%202px%2010px%20rgba(0,0,0,0.2);%20transform:translateX(calc(100%%20+%2025px));%20%20%20%20%20%20%20%20%20%20%20%20transition:transform%200.3s%20ease-in-out,%20opacity%200.3s;%20opacity:0;%20display:flex;%20align-items:center;%20%20%20%20%20%20%20%20%60;%20%20%20%20%20%20%20%20const%20icon%20=%20document.createElement('span');%20%20%20%20%20%20%20%20icon.style.marginRight%20=%20'8px';%20%20%20%20%20%20%20%20icon.style.fontSize%20=%20'16px';%20%20%20%20%20%20%20%20icon.innerHTML%20=%20isError%20?%20'&#x26A0;'%20:%20'&#x2714;';%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20closeBtn%20=%20document.createElement('span');%20%20%20%20%20%20%20%20closeBtn.textContent%20=%20'%C3%97';%20%20%20%20%20%20%20%20closeBtn.style.cssText%20=%20'margin-left:15px;%20cursor:pointer;%20font-weight:bold;%20font-size:18px;%20line-height:1;';%20%20%20%20%20%20%20%20closeBtn.onclick%20=%20()%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20n.style.transform%20=%20'translateX(calc(100%%20+%2025px))';%20%20%20%20%20%20%20%20%20%20%20%20n.style.opacity%20=%20'0';%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(()%20=%3E%20n.remove(),%20300);%20%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20n.appendChild(icon);%20%20%20%20%20%20%20%20n.appendChild(document.createTextNode(message));%20%20%20%20%20%20%20%20n.appendChild(closeBtn);%20%20%20%20%20%20%20%20document.body.appendChild(n);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(()%20=%3E%20{%20n.style.transform%20=%20'translateX(0)';%20n.style.opacity%20=%20'1';%20},%2050);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(duration%20%3E%200)%20{%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(()%20=%3E%20closeBtn.onclick(),%20duration);%20%20%20%20%20%20%20%20}%20%20%20%20},%20%20%20%20createDialogBase(idSuffix,%20contentHtml,%20minWidth%20=%20'350px',%20maxWidth%20=%20'600px',%20customStyles%20=%20'')%20{%20%20%20%20%20%20const%20id%20=%20%60${CONFIG.TOOL_ID_PREFIX}_${idSuffix}%60;%20%20%20%20%20%20document.getElementById(%60${id}_overlay%60)?.remove();%20%20%20%20%20%20const%20overlay%20=%20document.createElement('div');%20%20%20%20%20%20overlay.id%20=%20%60${id}_overlay%60;%20%20%20%20%20%20overlay.style.cssText%20=%20%60%20%20%20%20%20%20%20%20%20%20position:fixed;%20top:0;%20left:0;%20width:100%;%20height:100%;%20background:rgba(0,0,0,0.6);%20%20%20%20%20%20%20%20%20%20z-index:${CONFIG.Z_INDEX.OVERLAY};%20display:flex;%20align-items:center;%20justify-content:center;%20%20%20%20%20%20%20%20%20%20font-family:'Microsoft%20JhengHei',Arial,sans-serif;%20backdrop-filter:blur(2px);%20%20%20%20%20%20%60;%20%20%20%20%20%20const%20dialog%20=%20document.createElement('div');%20%20%20%20%20%20dialog.id%20=%20%60${id}_dialog%60;%20%20%20%20%20%20dialog.style.cssText%20=%20%60%20%20%20%20%20%20%20%20%20%20background:#fff;%20padding:20px%2025px;%20border-radius:8px;%20box-shadow:0%205px%2020px%20rgba(0,0,0,0.25);%20%20%20%20%20%20%20%20%20%20min-width:${minWidth};%20max-width:${maxWidth};%20width:auto;%20animation:qtDialogAppear%200.2s%20ease-out;%20${customStyles}%20%20%20%20%20%20%60;%20%20%20%20%20%20dialog.innerHTML%20=%20contentHtml;%20%20%20%20%20%20%20%20%20%20%20%20const%20styleEl%20=%20document.createElement('style');%20%20%20%20%20%20styleEl.textContent%20=%20%60%20%20%20%20%20%20%20%20@keyframes%20qtDialogAppear%20{%20from%20{%20opacity:0;%20transform:scale(0.95);%20}%20to%20{%20opacity:1;%20transform:scale(1);%20}%20}%20%20%20%20%20%20%20%20.qt-dialog-btn%20{%20border:none;%20padding:8px%2015px;%20border-radius:4px;%20font-size:13px;%20cursor:pointer;%20transition:%20opacity%200.2s;%20font-weight:500;%20margin-left:8px;%20}%20%20%20%20%20%20%20%20.qt-dialog-btn:hover%20{%20opacity:0.85;%20}%20.qt-dialog-btn:active%20{%20transform:scale(0.98);%20}%20%20%20%20%20%20%20%20.qt-dialog-btn-blue%20{%20background:#007bff;%20color:white;%20}%20.qt-dialog-btn-grey%20{%20background:#6c757d;%20color:white;%20}%20%20%20%20%20%20%20%20.qt-dialog-btn-red%20{%20background:#dc3545;%20color:white;%20}%20.qt-dialog-btn-orange%20{%20background:#fd7e14;%20color:white;%20}%20%20%20%20%20%20%20%20.qt-dialog-btn-green%20{%20background:#28a745;%20color:white;%20}%20.qt-dialog-btn-purple%20{%20background:#6f42c1;%20color:white;%20}%20%20%20%20%20%20%20%20.qt-dialog-title%20{%20margin:0%200%2015px%200;%20color:#333;%20font-size:18px;%20text-align:center;%20font-weight:600;%20}%20%20%20%20%20%20%20%20.qt-input,%20.qt-textarea,%20.qt-select%20{%20width:100%;%20padding:9px;%20border:1px%20solid%20#ccc;%20border-radius:4px;%20font-size:13px;%20margin-bottom:10px;%20box-sizing:border-box;%20}%20%20%20%20%20%20%20%20.qt-textarea%20{%20min-height:80px;%20resize:vertical;%20}%20%20%20%20%20%20%20%20.qt-flex-end%20{%20display:flex;%20justify-content:flex-end;%20margin-top:15px;%20}%20%20%20%20%20%20%60;%20%20%20%20%20%20dialog.appendChild(styleEl);%20%20%20%20%20%20overlay.appendChild(dialog);%20%20%20%20%20%20document.body.appendChild(overlay);%20%20%20%20%20%20return%20{%20overlay,%20dialog%20};%20%20%20%20},%20%20%20%20%20%20%20%20showLoadingDialog(title,%20message)%20{%20%20%20%20%20%20%20%20const%20contentHtml%20=%20%60%20%20%20%20%20%20%20%20%20%20%20%20%3Ch3%20class=%22qt-dialog-title%22%20id=%22${CONFIG.TOOL_ID_PREFIX}_LoadingTitle%22%3E${Utils.escapeHtml(title)}%3C/h3%3E%20%20%20%20%20%20%20%20%20%20%20%20%3Cp%20id=%22${CONFIG.TOOL_ID_PREFIX}_LoadingMsg%22%20style=%22text-align:center;font-size:13px;color:#555;%22%3E${Utils.escapeHtml(message)}%3C/p%3E%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%22width:40px;height:40px;border:4px%20solid%20#f3f3f3;border-top:4px%20solid%20#3498db;border-radius:50%;margin:15px%20auto;animation:qtSpin%201s%20linear%20infinite;%22%3E%3C/div%3E%20%20%20%20%20%20%20%20%60;%20%20%20%20%20%20%20%20const%20{%20overlay,%20dialog%20}%20=%20this.createDialogBase('Loading',%20contentHtml,%20'300px',%20'auto',%20'text-align:center;');%20%20%20%20%20%20%20%20return%20{%20%20%20%20%20%20%20%20%20%20%20%20overlay,%20%20%20%20%20%20%20%20%20%20%20%20update:%20(newTitle,%20newMsg)%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(newTitle)%20dialog.querySelector(%60#${CONFIG.TOOL_ID_PREFIX}_LoadingTitle%60).textContent%20=%20newTitle;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(newMsg)%20dialog.querySelector(%60#${CONFIG.TOOL_ID_PREFIX}_LoadingMsg%60).textContent%20=%20newMsg;%20%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20};%20%20%20%20},%20%20%20%20%20%20%20%20//%20...%20(All%20other%20UI-related%20functions%20will%20be%20methods%20here)%20%20%20%20//%20For%20brevity,%20only%20the%20main%20render%20function%20is%20fully%20shown.%20Others%20are%20conceptually%20moved.%20%20%20%20renderMainUI(dataToRender)%20{%20%20%20%20%20%20%20%20this.cleanup();%20//%20Clean%20up%20any%20previous%20UI%20instances%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20mainUI%20=%20document.createElement('div');%20%20%20%20%20%20%20%20this.dom.mainUI%20=%20mainUI;%20%20%20%20%20%20%20%20mainUI.id%20=%20CONFIG.TOOL_ID_PREFIX;%20%20%20%20%20%20%20%20//%20...%20(styles%20for%20mainUI)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20titleBar%20=%20document.createElement('div');%20%20%20%20%20%20%20%20//%20...%20(content%20and%20styles%20for%20titleBar)%20%20%20%20%20%20%20%20titleBar.onmousedown%20=%20this.dragStartListener.bind(this);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20...%20(creation%20of%20contentWrapper,%20controlsHeader,%20buttons,%20etc.)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20---%20Event%20Listeners%20for%20Controls%20---%20%20%20%20%20%20%20%20//%20Ex:%20mainUI.querySelector('#btn-id').onclick%20=%20()%20=%3E%20App.someAction();%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20...%20build%20the%20entire%20UI%20DOM%20tree%20...%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.body.appendChild(mainUI);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Add%20global%20listeners%20for%20this%20UI%20instance%20%20%20%20%20%20%20%20document.addEventListener('keydown',%20this.mainUIEscListener.bind(this));%20%20%20%20%20%20%20%20document.addEventListener('mousemove',%20this.dragMoveListener.bind(this));%20%20%20%20%20%20%20%20document.addEventListener('mouseup',%20this.dragEndListener.bind(this));%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.updateTable(dataToRender);%20//%20Initial%20render%20%20%20%20},%20%20%20%20%20%20%20%20updateTable(data)%20{%20%20%20%20%20%20%20%20//%20This%20function%20would%20call%20renderTableHeaders%20and%20populateTableRows%20%20%20%20%20%20%20%20//%20...%20%20%20%20},%20%20%20%20%20%20%20%20dragStartListener(e)%20{%20%20%20%20%20%20%20%20if%20(e.target%20!==%20e.currentTarget)%20return;%20%20%20%20%20%20%20%20e.preventDefault();%20%20%20%20%20%20%20%20this.state.drag%20=%20{%20%20%20%20%20%20%20%20%20%20%20%20dragging:%20true,%20%20%20%20%20%20%20%20%20%20%20%20startX:%20e.clientX,%20%20%20%20%20%20%20%20%20%20%20%20startY:%20e.clientY,%20%20%20%20%20%20%20%20%20%20%20%20initialX:%20this.dom.mainUI.offsetLeft,%20%20%20%20%20%20%20%20%20%20%20%20initialY:%20this.dom.mainUI.offsetTop,%20%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20e.currentTarget.style.cursor%20=%20'grabbing';%20%20%20%20%20%20%20%20this.dom.mainUI.style.transform%20=%20'none';%20//%20Switch%20to%20absolute%20positioning%20for%20drag%20%20%20%20},%20%20%20%20dragMoveListener(e)%20{%20%20%20%20%20%20%20%20if%20(!this.state.drag.dragging)%20return;%20%20%20%20%20%20%20%20const%20dx%20=%20e.clientX%20-%20this.state.drag.startX;%20%20%20%20%20%20%20%20const%20dy%20=%20e.clientY%20-%20this.state.drag.startY;%20%20%20%20%20%20%20%20this.dom.mainUI.style.left%20=%20%60${this.state.drag.initialX%20+%20dx}px%60;%20%20%20%20%20%20%20%20this.dom.mainUI.style.top%20=%20%60${this.state.drag.initialY%20+%20dy}px%60;%20%20%20%20},%20%20%20%20dragEndListener(e)%20{%20%20%20%20%20%20%20%20if%20(this.state.drag.dragging)%20{%20%20%20%20%20%20%20%20%20%20%20%20this.state.drag.dragging%20=%20false;%20%20%20%20%20%20%20%20%20%20%20%20this.dom.mainUI.querySelector('div').style.cursor%20=%20'grab';%20%20%20%20%20%20%20%20}%20%20%20%20},%20%20%20%20%20%20%20%20mainUIEscListener(e)%20{%20%20%20%20%20%20%20%20const%20isDialogActive%20=%20document.querySelector(%60[id^=%22${CONFIG.TOOL_ID_PREFIX}_%22][id$=%22_overlay%22]%60);%20%20%20%20%20%20%20%20if%20(e.key%20===%20'Escape'%20&&%20this.dom.mainUI%20&&%20!isDialogActive)%20{%20%20%20%20%20%20%20%20%20%20%20%20this.cleanup();%20%20%20%20%20%20%20%20}%20%20%20%20}%20%20};%20%20//%20==========%20Logic%20Managers%20==========%20%20const%20TokenManager%20=%20{%20%20%20%20get:%20()%20=%3E%20localStorage.getItem(CONFIG.STORAGE_KEYS.TOKEN),%20%20%20%20set:%20(token)%20=%3E%20localStorage.setItem(CONFIG.STORAGE_KEYS.TOKEN,%20token),%20%20%20%20clear:%20()%20=%3E%20localStorage.removeItem(CONFIG.STORAGE_KEYS.TOKEN),%20%20%20%20%20%20%20%20async%20prompt()%20{%20%20%20%20%20%20%20%20StateManager.apiAuthToken%20=%20this.get();%20%20%20%20%20%20%20%20if%20(StateManager.apiAuthToken)%20{%20%20%20%20%20%20%20%20%20%20%20%20UIManager.displayNotification('%E5%B7%B2%E8%BC%89%E5%85%A5%E5%84%B2%E5%AD%98%E7%9A%84Token',%20false);%20%20%20%20%20%20%20%20%20%20%20%20return%20true;%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20let%20attempt%20=%201;%20%20%20%20%20%20%20%20while(true)%20{%20%20%20%20%20%20%20%20%20%20%20%20%20const%20contentHtml%20=%20%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ch3%20class=%22qt-dialog-title%22%3EAPI%20TOKEN%20%E8%A8%AD%E5%AE%9A%3C/h3%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type=%22password%22%20id=%22qt-token-input%22%20class=%22qt-input%22%20placeholder=%22%E8%AB%8B%E8%BC%B8%E5%85%A5%E6%82%A8%E7%9A%84%20API%20TOKEN%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${attempt%20%3E%201%20?%20%60%3Cp%20style=%22color:red;%20font-size:12px;%20text-align:center;%22%3EToken%E7%82%BA%E7%A9%BA%EF%BC%8C%E8%AB%8B%E9%87%8D%E6%96%B0%E8%BC%B8%E5%85%A5%E3%80%82%3C/p%3E%60%20:%20''}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22qt-flex-end%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id=%22qt-token-skip%22%20class=%22qt-dialog-btn%20qt-dialog-btn-orange%22%3E%E7%95%A5%E9%81%8E%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id=%22qt-token-close%22%20class=%22qt-dialog-btn%20qt-dialog-btn-red%22%3E%E9%97%9C%E9%96%89%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id=%22qt-token-ok%22%20class=%22qt-dialog-btn%20qt-dialog-btn-blue%22%3E%E7%A2%BA%E5%AE%9A%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%60;%20%20%20%20%20%20%20%20%20%20%20%20const%20{%20overlay,%20dialog%20}%20=%20UIManager.createDialogBase('Token',%20contentHtml,%20'350px');%20%20%20%20%20%20%20%20%20%20%20%20const%20input%20=%20dialog.querySelector('#qt-token-input');%20%20%20%20%20%20%20%20%20%20%20%20input.focus();%20%20%20%20%20%20%20%20%20%20%20%20const%20userChoice%20=%20await%20new%20Promise(resolve%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dialog.querySelector('#qt-token-ok').onclick%20=%20()%20=%3E%20resolve(input.value.trim());%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dialog.querySelector('#qt-token-skip').onclick%20=%20()%20=%3E%20resolve('_skip_');%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dialog.querySelector('#qt-token-close').onclick%20=%20()%20=%3E%20resolve(null);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20overlay.onclick%20=%20(e)%20=%3E%20{%20if%20(e.target%20===%20overlay)%20resolve(null);%20};%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.onkeydown%20=%20(e)%20=%3E%20{%20if%20(e.key%20===%20'Escape')%20resolve(null);%20};%20%20%20%20%20%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20%20overlay.remove();%20%20%20%20%20%20%20%20%20%20%20%20document.onkeydown%20=%20null;%20%20%20%20%20%20%20%20%20%20%20%20if%20(userChoice%20===%20null)%20return%20false;%20//%20User%20cancelled%20%20%20%20%20%20%20%20%20%20%20%20if%20(userChoice%20===%20'_skip_')%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20StateManager.apiAuthToken%20=%20null;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20UIManager.displayNotification('%E5%B7%B2%E7%95%A5%E9%81%8EToken%E8%BC%B8%E5%85%A5',%20false);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true;%20%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20if%20(userChoice)%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20StateManager.apiAuthToken%20=%20userChoice;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.set(userChoice);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20UIManager.displayNotification('Token%E5%B7%B2%E8%A8%AD%E5%AE%9A%E4%B8%A6%E5%84%B2%E5%AD%98',%20false);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true;%20%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20attempt++;%20%20%20%20%20%20%20%20}%20%20%20%20}%20%20};%20%20const%20ApiManager%20=%20{%20%20%20%20%20%20async%20performQuery(queryValue,%20apiKey)%20{%20%20%20%20%20%20%20%20const%20reqBody%20=%20{%20currentPage:%201,%20pageSize:%2010,%20[apiKey]:%20queryValue%20};%20%20%20%20%20%20%20%20const%20fetchOpts%20=%20{%20%20%20%20%20%20%20%20%20%20%20%20method:%20'POST',%20%20%20%20%20%20%20%20%20%20%20%20headers:%20{%20'Content-Type':%20'application/json'%20},%20%20%20%20%20%20%20%20%20%20%20%20body:%20JSON.stringify(reqBody),%20%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20if%20(StateManager.apiAuthToken)%20{%20%20%20%20%20%20%20%20%20%20%20%20fetchOpts.headers['SSO-TOKEN']%20=%20StateManager.apiAuthToken;%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20%20%20%20const%20res%20=%20await%20fetch(CONFIG.API_URLS[StateManager.currentEnv],%20fetchOpts);%20%20%20%20%20%20%20%20%20%20%20%20if%20(res.status%20===%20401)%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20TokenManager.clear();%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20StateManager.apiAuthToken%20=%20null;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20{%20error:%20'token_invalid'%20};%20%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20if%20(!res.ok)%20throw%20new%20Error(%60API%20Error:%20${res.status}%60);%20%20%20%20%20%20%20%20%20%20%20%20const%20data%20=%20await%20res.json();%20%20%20%20%20%20%20%20%20%20%20%20return%20{%20success:%20data?.records?.length%20%3E%200,%20data%20};%20%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20%20%20%20console.error(%60Query%20for%20${queryValue}%20failed:%60,%20e);%20%20%20%20%20%20%20%20%20%20%20%20return%20{%20error:%20'network_error'%20};%20%20%20%20%20%20%20%20}%20%20%20%20%20%20}%20%20};%20%20%20%20//%20...%20Other%20managers%20like%20CSVManager,%20A17ModeManager%20would%20be%20defined%20here%20%20//%20==========%20%E4%B8%BB%E6%87%89%E7%94%A8%E7%A8%8B%E5%BC%8F%E6%8E%A7%E5%88%B6%E5%99%A8%20==========%20%20const%20App%20=%20{%20%20%20%20async%20run()%20{%20%20%20%20%20%20UIManager.cleanup();%20%20%20%20%20%20%20%20%20%20%20%20const%20env%20=%20await%20this.selectEnvironment();%20%20%20%20%20%20if%20(!env)%20return%20UIManager.displayNotification('%E6%93%8D%E4%BD%9C%E5%B7%B2%E5%8F%96%E6%B6%88',%20true);%20%20%20%20%20%20StateManager.currentEnv%20=%20env;%20%20%20%20%20%20UIManager.displayNotification(%60%E7%92%B0%E5%A2%83%E5%B7%B2%E8%A8%AD%E7%82%BA:%20${env.toUpperCase()}%60,%20false);%20%20%20%20%20%20const%20tokenOk%20=%20await%20TokenManager.prompt();%20%20%20%20%20%20if%20(!tokenOk)%20return%20UIManager.displayNotification('Token%E8%A8%AD%E5%AE%9A%E5%B7%B2%E5%8F%96%E6%B6%88',%20true);%20%20%20%20%20%20//%20This%20is%20where%20the%20old%20%60createQuerySetupDialog%60%20would%20be%20called%20%20%20%20%20%20//%20const%20queryConfig%20=%20await%20UIManager.showQuerySetupDialog();%20%20%20%20%20%20%20//%20if%20(!queryConfig)%20return;%20%20%20%20%20%20%20%20%20%20%20%20//%20...%20For%20brevity,%20skipping%20to%20showing%20results%20%20%20%20%20%20//%20In%20a%20full%20implementation,%20the%20query%20dialog%20logic%20would%20follow%20%20%20%20%20%20%20%20%20%20%20%20//%20Let's%20assume%20we%20have%20some%20results%20to%20show%20%20%20%20%20%20//%20StateManager.originalQueryResults%20=%20[...]%20%20%20%20%20%20UIManager.renderMainUI(StateManager.originalQueryResults);%20%20%20%20},%20%20%20%20async%20selectEnvironment()%20{%20%20%20%20%20%20%20%20const%20contentHtml%20=%20%60%20%20%20%20%20%20%20%20%20%20%20%20%3Ch3%20class=%22qt-dialog-title%22%3E%E9%81%B8%E6%93%87%E6%9F%A5%E8%A9%A2%E7%92%B0%E5%A2%83%3C/h3%3E%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%22display:flex;%20gap:10px;%20justify-content:center;%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id=%22qt-env-uat%22%20class=%22qt-dialog-btn%20qt-dialog-btn-green%22%20style=%22flex-grow:1;%22%3E%E6%B8%AC%E8%A9%A6%20(UAT)%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id=%22qt-env-prod%22%20class=%22qt-dialog-btn%20qt-dialog-btn-orange%22%20style=%22flex-grow:1;%22%3E%E6%AD%A3%E5%BC%8F%20(PROD)%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%20%20%20%20%20%20%20%20%60;%20%20%20%20%20%20%20%20const%20{%20overlay,%20dialog%20}%20=%20UIManager.createDialogBase('EnvSelect',%20contentHtml,%20'300px');%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20choice%20=%20await%20new%20Promise(resolve%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20dialog.querySelector('#qt-env-uat').onclick%20=%20()%20=%3E%20resolve('test');%20%20%20%20%20%20%20%20%20%20%20%20dialog.querySelector('#qt-env-prod').onclick%20=%20()%20=%3E%20resolve('prod');%20%20%20%20%20%20%20%20%20%20%20%20overlay.onclick%20=%20(e)%20=%3E%20{%20if%20(e.target%20===%20overlay)%20resolve(null);%20};%20%20%20%20%20%20%20%20%20%20%20%20document.onkeydown%20=%20(e)%20=%3E%20{%20if%20(e.key%20===%20'Escape')%20resolve(null);%20};%20%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20overlay.remove();%20%20%20%20%20%20%20%20document.onkeydown%20=%20null;%20%20%20%20%20%20%20%20return%20choice;%20%20%20%20},%20%20%20%20%20%20%20%20//%20...%20all%20other%20high-level%20application%20logic%20%20};%20%20//%20---%20%E5%95%9F%E5%8B%95%20---%20%20App.run();})();